INSERT INTO CUSTOMERCONTACTEMAIL 
(
	UUID,
	EMAILADDRESS,
	CUSTOMERID,
	CREATEDATE,
	LASTUPDATEDATE,
	CREATORID,
	LASTUPDATERID,
	SOURCE,
	TYPEID,
	STATUS,
	SOURCEREFERENCEID,
	HISTORICAL,
	ISDEFAULT,
	EMAILTYPEREFERENCEID,
	EXPRESSCONSENT,
	ESIGNCONSENT,
	EMAILCONSENTSOURCE,
	ESIGNEMAILCONSENTSOURCE
)
SELECT
	SYS_GUID() AS UUID,
	espei.EMAIL_ADDRESS	AS EMAILADDRESS ,
	c.CUSTOMERID,
	SYSDATE AS CREATEDATE,
	SYSDATE AS LASTUPDATEDATE,
    (SELECT ID FROM COM_FINVI_OASIS_ACCOUNT_RSIT.user_ WHERE USERNAME = 'etlmigrationuser@finvi.com') AS CREATORID,
    (SELECT ID FROM COM_FINVI_OASIS_ACCOUNT_RSIT.user_ WHERE USERNAME = 'etlmigrationuser@finvi.com') AS LASTUPDATERID,	
	'CONSUMER' AS SOURCE,
	1 AS TYPEID,
	'VERIFIED' AS STATUS,
	(SELECT ID FROM COM_FINVI_OASIS_STATIC_DATA_RSIT.DEMOGRAPHIC_SOURCE WHERE SOURCE='Consumer') AS SOURCEREFERENCEID,
	'N' AS HISTORICAL, 
	'Y' AS ISDEFAULT,
	(SELECT ID FROM COM_FINVI_OASIS_STATIC_DATA_RSIT.EMAIL_TYPE et WHERE NAME = 'HomeEmail' AND IS_ACTIVE = 1) AS EMAILTYPEREFERENCEID,
	'NA' AS EXPRESSCONSENT,
	'NA' AS ESIGNCONSENT,	
	(SELECT ID FROM COM_FINVI_OASIS_STATIC_DATA_RSIT.CONSENT_SOURCE WHERE NAME = 'System' AND ISACTIVE = 1) AS EMAILCONSENTSOURCE,
	(SELECT ID FROM COM_FINVI_OASIS_STATIC_DATA_RSIT.CONSENT_SOURCE WHERE NAME = 'System' AND ISACTIVE = 1) AS ESIGNEMAILCONSENTSOURCE	
FROM
	ETL_OASIS_DATA_MIG_RSIT.ETL_STG_PRTY_EMAIL_INFO espei
	INNER JOIN COM_FINVI_OASIS_ACCOUNT_RSIT.CUSTOMER c ON c.MIGRATION_SOURCE_ID = espei.CONSUMERID
WHERE espei.EMAIL_ADDRESS IS NOT NULL